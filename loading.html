<script>
  const messages = [
    "Connecting to servers...",
    "Successfully connected.",
    "Finding username...",
    "Username found!",
    "Generating items...",
    "Starting transfer...",
    "Verifying human activity...",
  ];

  const colors = {
    3: "green",
    5: "green",
    6: "black"
  };

  let index = 0;

  function typeWriter(text, i, callback, color) {
    if (i < text.length) {
      const status = document.getElementById("statusText");
      status.innerHTML = text.substring(0, i + 1);
      if (color) status.style.color = color;
      setTimeout(() => typeWriter(text, i + 1, callback, color), 40);
    } else {
      if (callback) setTimeout(callback, text.includes("Verifying human activity") ? 4000 : 1000);
    }
  }

  function updateDot(dotIndex) {
    const dot = document.getElementById(`dot${dotIndex}`);
    if (dot) dot.classList.add("active");
  }

  function startTypingSequence() {
    if (index >= messages.length) {
      document.getElementById("statusText").innerHTML = "Human Verification Required.";
      document.getElementById("statusText").style.color = "red";

      const verifySection = document.getElementById("verifySection");
      verifySection.style.display = "block";

      const verifyBtn = verifySection.querySelector(".verify-btn");
      verifyBtn.classList.add("zoom-effect");

      updateDot(5);
      return;
    }

    const color = colors[index] || "black";
    typeWriter(messages[index], 0, () => {
      updateDot(index + 1);
      index++;
      startTypingSequence();
    }, color);
  }

  function showOffer() {
    document.getElementById("offerPopup").style.display = "block";
  }

  if (!sessionStorage.getItem("usernameEntered")) {
    window.location.href = "index.html";
  } else {
    sessionStorage.removeItem("usernameEntered");
    startTypingSequence();
  }
</script>
